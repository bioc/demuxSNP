library(devtools)
create_package()
create_package("C:/Users/michael.lynch/Culhane_Lab Dropbox/Shared_Lab_Folder/SNPs/github/")
library(devtools)
create_package("C:/Users/michael.lynch/Culhane_Lab Dropbox/Shared_Lab_Folder/SNPs/github")
create_package("C:/Users/michael.lynch/Culhane_Lab Dropbox/Shared_Lab_Folder/SNPs/github/SNPcheck")
use_r("common_genes")
library(devtools)
use_r("common_genes")
?counts
library(SingleCellExperiment)
?counts
load("C:/Users/michael.lynch/Culhane_Lab Dropbox/Shared_Lab_Folder/broad_datasets/KW9275_Yufei/EDA_Reports/Final/data_import_and_preprocessing.RData")
?sort
?names
sce<-broad.sce
#common_genes<-function(sce) {
counts_matrix<-SingleCellExperiment::counts(sce)
gene_present<-counts_matrix>1
cells_per_gene<-base::rowSums(gene_present)
prop_cells<-base::rowSums(gene_present)/ncol(gene_present)
dim(gene_present)
cells_per_gene<-base::rowSums(gene_present)
rowSums(gene_present)
?rowSums
base::rowSums(gene_present)
Matrix::rowSums(gene_present)
cells_per_gene<-Matrix::rowSums(gene_present)
prop_cells<-base::rowSums(gene_present)/ncol(gene_present)
prop_cells<-Matrix::rowSums(gene_present)/ncol(gene_present)
sorted_top_genes<-base::sort(prop_cells,decreasing = TRUE)[1:100]
top_genes<-base::names(sorted_top_genes)
library(devtools)
load_all()
common_genes(broad.sce)
load_all()
common_genes(broad.sce)
tg<-common_genes(broad.sce)
check()
use_package("Matrix")
use_package("SingleCellExperiment")
check()
use_r("subset.vcf")
use_r("subset_vcf")
?readVcf
??readVcf
BiocManager::install(VariantAnnotation)
BiocManager::install("VariantAnnotation")
library(VariantAnnotation)
use_package("VariantAnnotation")
BiocManager::install(EnsDb.Hsapiens.v86)
BiocManager::install("EnsDb.Hsapiens.v86")
library(EnsDb.Hsapiens)
library(EnsDb.Hsapiens.v86)
?rowRanges
library(GenomicRanges)
?rowRanges
?%within%
?'%within%'
BiocManager::install("IRanges")
library(IRanges)
vcf_path<-"C:/Users/michael.lynch/Culhane_Lab Dropbox/Shared_Lab_Folder/SNPs/Data/common_variants/genome1K.phase3.SNP_AF5e2.chr1toX.hg38.vcf"
#subset_vcf<-function(vcf_path) {
my_vcf<-VariantAnnotation::readVcf(vcf_path)
SNP_ranges<-SummarizedExperiment::rowRanges(my_vcf)
top_gene_ranges<-SummarizedExperiment::rowRanges(top_genes)
?genes
gns <- ensembldb::genes(EnsDb.Hsapiens.v86)
?'%in%'
?mcols
#top_gene_ranges<-SummarizedExperiment::rowRanges(top_genes)
top_gene_ranges<-gns[mcols(gns)$gene_name %in% names(topgenes)]
#top_gene_ranges<-SummarizedExperiment::rowRanges(top_genes)
top_gene_ranges<-gns[mcols(gns)$gene_name %in% names(top_genes)]
top_genes_vcf<-my_vcf[IRanges::overlapsAny(SNP_ranges, top_gene_ranges,type="within")]
#top_gene_ranges<-SummarizedExperiment::rowRanges(top_genes)
top_gene_ranges<-gns[mcols(gns)$gene_name %in% names(top_genes)]
IRanges::overlapsAny(SNP_ranges, top_gene_ranges,type="within")
#subset_vcf<-function(vcf_path) {
my_vcf<-VariantAnnotation::readVcf(vcf_path,"GRCh38")
SNP_ranges<-SummarizedExperiment::rowRanges(my_vcf)
gns <- ensembldb::genes(EnsDb.Hsapiens.v86)
#top_gene_ranges<-SummarizedExperiment::rowRanges(top_genes)
top_gene_ranges<-gns[mcols(gns)$gene_name %in% names(top_genes)]
top_genes_vcf<-my_vcf[IRanges::overlapsAny(SNP_ranges, top_gene_ranges,type="within")]
#subset_vcf<-function(vcf_path) {
my_vcf<-VariantAnnotation::readVcf(vcf_path,"GRCh38")
#subset_vcf<-function(vcf_path) {
my_vcf<-VariantAnnotation::readVcf(vcf_path,"GRCh38")
SNP_ranges<-SummarizedExperiment::rowRanges(my_vcf)
my_vcf_inbound<-my_vcf[end(RR)<=seqlengths(SNP_ranges)[as.character(seqnames(SNP_ranges))]]
my_vcf_inbound<-my_vcf[end(SNP_ranges)<=seqlengths(SNP_ranges)[as.character(seqnames(SNP_ranges))]]
SNP_ranges_inbound<-SummarizedExperiment::rowRanges(my_vcf_inbound)
gns <- ensembldb::genes(EnsDb.Hsapiens.v86)
#top_gene_ranges<-SummarizedExperiment::rowRanges(top_genes)
top_gene_ranges<-gns[mcols(gns)$gene_name %in% names(top_genes)]
top_genes_vcf<-my_vcf[IRanges::overlapsAny(SNP_ranges, top_gene_ranges,type="within")]
top_genes_vcf<-my_vcf_inbound[IRanges::overlapsAny(SNP_ranges_inbound, top_gene_ranges,type="within")]
seqlengths(SNP_ranges_inbound)<-NA
seqlengths(top_gene_ranges)<-NA
top_genes_vcf<-my_vcf_inbound[IRanges::overlapsAny(SNP_ranges_inbound, top_gene_ranges,type="within")]
#}
getwd()
writeVcf(top_genes_vcf,'reducedSNPs.vcf')
check()
check()
check()
?`end
?end
my_vcf_inbound<-my_vcf[BiocGenerics::end(SNP_ranges)<=seqlengths(SNP_ranges)[as.character(seqnames(SNP_ranges))]]
?seqlengths
?as.character
GenomicInfoDb::seqlengths(SNP_ranges_inbound)<-NA
?seqlengths
GenomeInfoDb::seqlengths(SNP_ranges_inbound)<-NA
check()
?writeVcf
use_package(IRanges)
use_package("IRanges")
check()
use_package("BiocGenerics")
use_package("SummarizedExperiment")
use_package("GenomeInfoDb")
use_package("a")
check()
use_package("ensembldb")
check()
gns$gene_name
mcols(gene)$genename
mcols(gns)$genename
mcols(gns)$gene_name
check()
document()
document()
document()
load_all()
document_all()
library(devtools)
load_all()
document()
?subset_vcf
document()
?common_genes
use_r("run_vartrix")
cells_x_snps<-as.matrix(readMM("C:/Users/lynch/Culhane_Lab Dropbox/Shared_Lab_Folder/SNPs/v_outs_full.mtx"))
library(Matrix)
cells_x_snps<-as.matrix(readMM("C:/Users/lynch/Culhane_Lab Dropbox/Shared_Lab_Folder/SNPs/v_outs_full.mtx"))
cells_x_snps<-as.matrix(readMM("C:/Users/michael.lynch/Culhane_Lab Dropbox/Shared_Lab_Folder/SNPs/v_outs_full.mtx"))
dim(cells_x_snps)
rownames(cells_x_snps)
use_data(cells_x_snps)
library(devtools)
use_data(cells_x_snps)
use_r("visualise")
use_r("consensus_calls")
check()
install.package("devtools")
install.packages("devtools")
library(devtools)
library(devtools)
devtools::document()
library(CiteFuse)
library(Citefuse)
BiocManager::install("CiteFuse")
library(XirwDuaw)
library(CiteFuse)
library(CiteFuse)
BiocManager::install("CiteFuse")
library(CiteFuse)
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("CiteFuse")
BiocManager::install("CiteFuse")
library(CiteFuse)
library(CiteFuse)
remove.packages("CiteFuse")
BiocManager::install("CiteFuse")
library(CiteFuse)
install.packages(c("cli", "purrr", "xfun"))
install.packages(c("cli", "purrr", "xfun"))
library(CiteFuse)
library(CiteFuse)
remove.packages("CiteFuse")
knitr::opts_chunk$set(echo = TRUE)
load("data_import_and_preprocessing.RData")
counts(broad.sce)
library(SingleCellExperiment)
counts(broad.sce)
counts(broad.seurat)
assays(broad.sce)
counts(broad.sce)
load("C:/Users/michael.lynch/Documents/snp_data.RData")
load("C:/Users/michael.lynch/Documents/snps_data.RData")
counts(SNPsce)
SingleCellExperiment::counts(SNPsce)
SingleCellExperiment::counts(SNPsce)
SingleCellExperiment::counts(SNPsce)
library(devtools)
common_genes(SNPsce)
load_all()
common_genes(SNPsce)
SingleCellExperiment::counts(SNPsce)
library(BiocGenerics)
SingleCellExperiment::counts(SNPsce)
install.packages(Matrix)
install.packages("Matrix")
SingleCellExperiment::counts(SNPsce)
library(devtools)
load_all()
consensus_calls(SNPsce)
SingleCellExperiment::counts(SNPsce)
remove.packages("Matrix", lib="C:/Program Files/R/R-4.2.2/library")
install.packages("Matrix")
detach("package:IRanges", unload = TRUE)
detach("package:grDevices", unload = TRUE)
detach("package:graphics", unload = TRUE)
detach("package:GenomicRanges", unload = TRUE)
detach("package:GenomeInfoDb", unload = TRUE)
detach("package:MatrixGenerics", unload = TRUE)
detach("package:SingleCellExperiment", unload = TRUE)
library(SingleCellExperiment)
counts(SNPsce)
library(devtools)
load_all()
counts(SNPsce)
counts(SNPsce)
consensus_calls(SnPsce)
consensus_calls(SNPsce)
counts(SNPsce)
load_all()
load_all()
consensus_calls(SNPsce)
detach("package:SingleCellExperiment", unload = TRUE)
detach("package:stats", unload = TRUE)
detach("package:stats4", unload = TRUE)
detach("package:XVector", unload = TRUE)
detach("package:S4Vectors", unload = TRUE)
detach("package:Rsamtools", unload = TRUE)
detach("package:VariantAnnotation", unload = TRUE)
detach("package:SummarizedExperiment", unload = TRUE)
library(SingleCellExperiment)
count(SNPsce)
counts(SNPsce)
load("C:/Users/michael.lynch/Documents/snps_data.RData")
counts(SNPsce)
library(devtools)
load_all
load_all()
consensus_calls(SNPsce)
sce2<-consensus_calls(SNPsce)
CiteFuse::crossSampleDoublets(SNPsce)$crossSampleDoublets
load_all()
sce2<-consensus_calls(SNPsce)
result<-CiteFuse::crossSampleDoublets(SNPsce)
SNPsce<-CiteFuse::crossSampleDoublets(SNPsce)
result2<-CiteFuse::crossSampleDoublets(SNPsce)
result2$doubletClassify_between_label
rm(result)
rm(result2)
rm(sce2)
SNPsce$doubletClassify_between_label
SNPsce$doubletClassify_between_class<-NULL
SNPsce$doubletClassify_between_label<-NULL
consensus_calls(SNPsce)
sce<-SNPsce
result<-CiteFuse::crossSampleDoublets(sce)
sce$citefuse<-result$doubletClassify_between_label
library(devtools)
load_all
load_all()
consensus_calls(SNPsce)
SNPsce<-consensus_calls(SNPsce)
SNPsce$citefuse
SNPseurat<-as.Seurat(SNPsce)
library(Seurat)
SNPseurat<-as.Seurat(SNPsce)
sessionInfo()
install.packages("Seurat")
install.packages("Seurat")
library(Seurat)
SNPseurat<-as.Seurat(SNPsce)
install.packages("Matrix")
install.packages("Matrix")
detach("package:Biobase", unload = TRUE)
detach("package:BiocGenerics", unload = TRUE)
detach("package:Biostrings", unload = TRUE)
detach("package:Rsamtools", unload = TRUE)
detach("package:VariantAnnotation", unload = TRUE)
detach("package:Rsamtools", unload = TRUE)
install.packages("Matrix")
detach(Matrix)
detach("Matrix")
?detach
detach("package:BiocGenerics", unload = TRUE)
detach("package:Biostrings", unload = TRUE)
detach("package:datasets", unload = TRUE)
detach("package:GenomeInfoDb", unload = TRUE)
detach("package:GenomicRanges", unload = TRUE)
detach("package:MatrixGenerics", unload = TRUE)
detach("package:SummarizedExperiment", unload = TRUE)
detach("package:SingleCellExperiment", unload = TRUE)
detach("package:SummarizedExperiment", unload = TRUE)
detach("package:GenomicRanges", unload = TRUE)
getwd()
load_all
load_all()
library(devtools)
load_all()
load("C:/Users/michael.lynch/Desktop/snps.RData")
test.sce<-snps.sce
test.sce<-consensus_calls(test.sce)
?altExp
load_all()
test.sce<-consensus_calls(test.sce)
test.sce$predict
test.sce$citefuse
test.sce<-add_snps(test.sce,snps.mat)
?SingleCellExperiment
?colnames
load_all()
test.sce<-add_snps(test.sce,snps.mat)
dim(snps.mat)
load_all()
test.sce<-add_snps(test.sce,snps.mat)
mat<-snps.mat
#add_snps<-function(sce,mat,thresh=0.8) {
mat_obs<-mat[rowSums(mat)/dim(mat)[2]>thresh]
thresh<-0.8
#add_snps<-function(sce,mat,thresh=0.8) {
mat_obs<-mat[rowSums(mat)/dim(mat)[2]>thresh]
se<-SingleCellExperiment::SingleCellExperiment(list(counts=mat_obs))
dim(mat_obs)
as.mat(mat_obs)
as.matrix(mat_obs)
dim(as.matrix(mat_obs))
rowSums(mat)
rowSums(mat)/dim(mat)[2]
rowSums(mat)/dim(mat)[1]
rowSums(mat>0)/dim(mat)[1]
rowSums(mat>0)/dim(mat)[2]
#add_snps<-function(sce,mat,thresh=0.8) {
mat_obs<-mat[(rowSums(mat>0)/dim(mat)[2]) > thresh]
dim(mat_obs)
#add_snps<-function(sce,mat,thresh=0.8) {
mat_obs<-mat[(rowSums(mat>0)/dim(mat)[2]) > thresh,]
dim(mat_obs)
#add_snps<-function(sce,mat,thresh=0.8) {
mat_obs<-mat[(rowSums(mat>0)/dim(mat)[2]) > thresh,]
se<-SingleCellExperiment::SingleCellExperiment(list(counts=mat_obs))
colnames(se)<-colnames(sce)
load_all()
test.sce<-add_snps(test.sce)
test.sce<-add_snps(test.sce,snps.mat)
test.sce
altExp(test.sce,"SNP")
SingleCellExperiment::altExp(test.sce,"SNP")
use_vignette("my-vignette")
load_all()
check()
?counts
subset_vcf(vcf,snps.sce)
subset_vcf(vcf,snps.sce)
EnsDb.Hsapiens.v86::EnsDb.Hsapiens.v86
subset_vcf(vcf,snps.sce)
EnsDb.Hsapiens.v86
EnsDb.Hsapiens.v86::EnsDb.Hsapiens.v86
load_all()
subset_vcf(vcf,snps.sce)
check()
use_package("CiteFuse")
use_package("Seurat")
use_package("class")
use_package("EnsDb.Hsapiens.v86")
load_all()
check()
