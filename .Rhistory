GenomeInfoDb::seqlengths(top_gene_ranges)<-NA
top_genes_vcf<-my_vcf_inbound[IRanges::overlapsAny(SNP_ranges_inbound, top_gene_ranges,type="within")]
top_genes_vcf
top_gene_ranges
names(top_genes)
top_genes
top_gene_ranges<-gns[gns$gene_name %in% top_genes]
top_gene_ranges
subset_vcf(vcf,sce,top_genes)
load_all()
subset_vcf(vcf,sce,top_genes)
load_all()
subset_vcf(vcf,sce,top_genes)
subset_vcf(vcf,sce,top_genes)
subset_vcf(my_vcf=vcf,sce,top_genes)
test<-vcf
test
subset_vcf(test,sce,top_genes)
my_vcf<-vcf
#my_vcf<-VariantAnnotation::readVcf('full.vcf',"GRCh38")
SNP_ranges<-SummarizedExperiment::rowRanges(my_vcf)
my_vcf_inbound<-my_vcf[BiocGenerics::end(SNP_ranges)<=GenomeInfoDb::seqlengths(SNP_ranges)[as.character(GenomeInfoDb::seqnames(SNP_ranges))]]
SNP_ranges_inbound<-SummarizedExperiment::rowRanges(my_vcf_inbound)
gns <- ensembldb::genes(EnsDb.Hsapiens.v86::EnsDb.Hsapiens.v86)
top_gene_ranges<-gns[gns$gene_name %in% top_genes]
top_gene_ranges
GenomeInfoDb::seqlengths(SNP_ranges_inbound)<-NA
GenomeInfoDb::seqlengths(top_gene_ranges)<-NA
top_genes_vcf<-my_vcf_inbound[IRanges::overlapsAny(SNP_ranges_inbound, top_gene_ranges,type="within")]
top_genes_vcf<-my_vcf_inbound[IRanges::overlapsAny(SNP_ranges_inbound, top_gene_ranges,type="within")]
top_genes_vcf
overlapsAny(SNP_ranges_inbound, top_gene_ranges,type="within")
sum(overlapsAny(SNP_ranges_inbound, top_gene_ranges,type="within"))
sum(SNP_ranges_inbound %within% top_gene_ranges)
knitr::opts_chunk$set(echo = TRUE, engine.path="C:/Windows/System32/bash.exe")
library(Seurat)
library(VariantAnnotation)
library(EnsDb.Hsapiens.v86)
library(Matrix)
data.dir="D:/Culhane_Lab Dropbox/Shared_Lab_Folder/broad_datasets/KW9275_Yufei/210827_10X_KW9275_bcl/cellranger-6.1.1/GRCh38/BRI-1348/outs/filtered_feature_bc_matrix"
broad<-Read10X(
data.dir,
gene.column = 2,
cell.column = 1,
unique.features = TRUE,
strip.suffix = FALSE
)
data.dir="C:/Users/michael.lynch/Culhane_Lab Dropbox/Shared_Lab_Folder/broad_datasets/KW9275_Yufei/210827_10X_KW9275_bcl/cellranger-6.1.1/GRCh38/BRI-1348/outs/filtered_feature_bc_matrix"
broad<-Read10X(
data.dir,
gene.column = 2,
cell.column = 1,
unique.features = TRUE,
strip.suffix = FALSE
)
broad.seurat<-CreateSeuratObject(broad$`Gene Expression`)
myvcf<-readVcf("./Data/common_variants/genome1K.phase3.SNP_AF5e2.chr1toX.hg38.vcf","GRCh38")
broad.counts<-broad.seurat[["RNA"]]@counts
dim(broad.counts)
broad.counts.bool<-broad.counts>0
# count amount of cells which express each gene
cellspergene<-rowSums(broad.counts.bool)
# count proportions of cells which express each gene
prop_cells<-rowSums(broad.counts.bool)/ncol(broad.counts.bool)
#hist(cellspergene)
#hist(prop_cells)
sum(cellspergene>20000)
sorted_topgenes<-sort(cellspergene,decreasing=TRUE)
sorted_topgenes[1:50]
plot(sorted_topgenes[1:100])
RR<-rowRanges(myvcf)
#number of inbounds and out of bounds SNPs
sum(end(RR)<seqlengths(RR)[as.character(seqnames(RR))])
sum(end(RR)>seqlengths(RR)[as.character(seqnames(RR))])
# Out of bounds indices
OOB<-myvcf[end(RR)>seqlengths(RR)[as.character(seqnames(RR))]]
# in bounds subsetting
IB<-myvcf[end(RR)<=seqlengths(RR)[as.character(seqnames(RR))]]
RR_IB<-rowRanges(IB)
# gene locations from ensdb grch38 version
gns <- genes(EnsDb.Hsapiens.v86)
# gene locations subsetted by top genes
top_gene_ranges<-gns[mcols(gns)$gene_name %in% names(sorted_topgenes[1:100])]
top_gene_ranges
sce<-sce
vcf<-vcf
SNP_ranges<-SummarizedExperiment::rowRanges(my_vcf)
my_vcf<-vcf
SNP_ranges<-SummarizedExperiment::rowRanges(my_vcf)
my_vcf_inbound<-my_vcf[BiocGenerics::end(SNP_ranges)<=GenomeInfoDb::seqlengths(SNP_ranges)[as.character(GenomeInfoDb::seqnames(SNP_ranges))]]
SNP_ranges_inbound<-SummarizedExperiment::rowRanges(my_vcf_inbound)
gns <- ensembldb::genes(EnsDb.Hsapiens.v86::EnsDb.Hsapiens.v86)
top_gene_ranges2<-gns[gns$gene_name %in% top_genes]
top_genes<-common_genes(sce)
SNP_ranges<-SummarizedExperiment::rowRanges(my_vcf)
my_vcf_inbound<-my_vcf[BiocGenerics::end(SNP_ranges)<=GenomeInfoDb::seqlengths(SNP_ranges)[as.character(GenomeInfoDb::seqnames(SNP_ranges))]]
SNP_ranges_inbound<-SummarizedExperiment::rowRanges(my_vcf_inbound)
gns <- ensembldb::genes(EnsDb.Hsapiens.v86::EnsDb.Hsapiens.v86)
top_gene_ranges2<-gns[gns$gene_name %in% top_genes]
top_gene_ranges
top_gene_ranges2
top_gene_ranges==top_gene_ranges2
top_gene_ranges
head(top_gene_ranges)
head(top_gene_ranges2)
top_gene_ranges$gene_id==top_gene_ranges2$gene_id
length(top_gene_ranges)
length(top_gene_ranges22)
length(top_gene_ranges2)
t2<-common_genes(sce)
sorted_topgenes[1:100]
intersect(t2,sorted_topgenes[1:100])
t2
as.top_genes
top_genes
names(sorted_topgenes[1:100])
intersect(t2,names(sorted_topgenes[1:100]))
load_all()
t3<-common_genes(sce)
intersect(t3,t2)
subset_vcf(vcf,sce,t3)
top_genes<-common_genes(sce = sce)
load_all()
top_genes<-common_genes(sce)
subset_vcf(vcf,sce,top_genes)
sce<-sce
vcf<-vcf
#my_vcf<-VariantAnnotation::readVcf('full.vcf',"GRCh38")
SNP_ranges<-SummarizedExperiment::rowRanges(my_vcf)
my_vcf<-vcf
top_genes<-common_genes(sce)
#my_vcf<-VariantAnnotation::readVcf('full.vcf',"GRCh38")
SNP_ranges<-SummarizedExperiment::rowRanges(my_vcf)
SNP_ranges
my_vcf_inbound<-my_vcf[BiocGenerics::end(SNP_ranges)<=GenomeInfoDb::seqlengths(SNP_ranges)[as.character(GenomeInfoDb::seqnames(SNP_ranges))]]
SNP_ranges_inbound<-SummarizedExperiment::rowRanges(my_vcf_inbound)
SNP_ranges_inbound
gns <- ensembldb::genes(EnsDb.Hsapiens.v86::EnsDb.Hsapiens.v86)
gns
top_gene_ranges<-gns[gns$gene_name %in% top_genes]
top_gene_ranges
GenomeInfoDb::seqlengths(SNP_ranges_inbound)<-NA
GenomeInfoDb::seqlengths(top_gene_ranges)<-NA
overlapsAny(SNP_ranges_inbound, top_gene_ranges,type="within")
sum(overlapsAny(SNP_ranges_inbound, top_gene_ranges,type="within"))
myvcf<-readVcf("./Data/common_variants/genome1K.phase3.SNP_AF5e2.chr1toX.hg38.vcf","GRCh38")
RR<-rowRanges(myvcf)
#number of inbounds and out of bounds SNPs
sum(end(RR)<seqlengths(RR)[as.character(seqnames(RR))])
sum(end(RR)>seqlengths(RR)[as.character(seqnames(RR))])
# Out of bounds indices
OOB<-myvcf[end(RR)>seqlengths(RR)[as.character(seqnames(RR))]]
# in bounds subsetting
IB<-myvcf[end(RR)<=seqlengths(RR)[as.character(seqnames(RR))]]
my_vcf_inbound
RR_IB<-rowRanges(IB)
# gene locations from ensdb grch38 version
gns <- genes(EnsDb.Hsapiens.v86)
# gene locations subsetted by top genes
top_gene_ranges<-gns[mcols(gns)$gene_name %in% top_genes]
# set seqlength for both to NA to as they differ
seqlengths(RR_IB)<-NA
seqlengths(top_gene_ranges)<-NA
# subset snps file to those within ranges of top genes
SNPs_from_top_genes<-IB[RR_IB %within% top_gene_ranges]
SNPs_from_top_genes
?`mcols<-,VCF,ANY-method`
?mcol
?mcols
top_gene_ranges<-gns[mcols(gns)$gene_name %in% top_genes]
GenomeInfoDb::seqlengths(SNP_ranges_inbound)<-NA
GenomeInfoDb::seqlengths(top_gene_ranges)<-NA
top_genes_vcf<-my_vcf_inbound[IRanges::overlapsAny(SNP_ranges_inbound, top_gene_ranges,type="within")]
top_genes_vcf
# row ranges of in bounds snps
RR_IB<-rowRanges(IB)
# gene locations from ensdb grch38 version
gns <- genes(EnsDb.Hsapiens.v86)
# gene locations subsetted by top genes
top_gene_ranges2<-gns[mcols(gns)$gene_name %in% top_genes]
# set seqlength for both to NA to as they differ
seqlengths(RR_IB)<-NA
seqlengths(top_gene_ranges)<-NA
# subset snps file to those within ranges of top genes
SNPs_from_top_genes<-IB[RR_IB %within% top_gene_ranges]
# write to vcf file
writeVcf(SNPs_from_top_genes,'./Data/common_variants/SNPs_from_common_genes.vcf')
SNP_ranges_inbound
library(devtools)
load_all()
subset_vcf(vcf,sce,top_genes)
# row ranges of in bounds snps
RR_IB<-rowRanges(IB)
# gene locations from ensdb grch38 version
gns <- genes(EnsDb.Hsapiens.v86)
# gene locations subsetted by top genes
top_gene_ranges<-gns[mcols(gns)$gene_name %in% top_genes]
# set seqlength for both to NA to as they differ
seqlengths(RR_IB)<-NA
seqlengths(top_gene_ranges)<-NA
# subset snps file to those within ranges of top genes
SNPs_from_top_genes<-IB[RR_IB %within% top_gene_ranges]
# write to vcf file
writeVcf(SNPs_from_top_genes,'./Data/common_variants/SNPs_from_common_genes.vcf')
SNPs_from_top_genes
top_genes_vcf<-my_vcf_inbound[IRanges::overlapsAny(SNP_ranges_inbound, top_gene_ranges,type="within")]
top_genes_vcf
top_genes_vcf<-my_vcf_inbound[SNP_ranges_inbound %within% top_gene_ranges]
top_genes_vcf
top_genes_vcf<-IB[SNP_ranges_inbound %within% top_gene_ranges]
top_genes_vcf
RR_IB
SNP_ranges_inbound
top_genes_vcf<-IB[RR_IB %within% top_gene_ranges]
top_genes_vcf
?rowRanges
my_vcf_inbound<-my_vcf[BiocGenerics::end(SNP_ranges)<=GenomeInfoDb::seqlengths(SNP_ranges)[as.character(GenomeInfoDb::seqnames(SNP_ranges))]]
library(VariantAnnotation)
?rowRanges
SNP_ranges<-SummarizedExperiment::rowRanges(my_vcf)
my_vcf_inbound<-my_vcf[BiocGenerics::end(SNP_ranges)<=GenomeInfoDb::seqlengths(SNP_ranges)[as.character(GenomeInfoDb::seqnames(SNP_ranges))]]
SNP_ranges_inbound<-SummarizedExperiment::rowRanges(my_vcf_inbound)
gns <- ensembldb::genes(EnsDb.Hsapiens.v86::EnsDb.Hsapiens.v86)
top_gene_ranges<-gns[mcols(gns)$gene_name %in% top_genes]
GenomeInfoDb::seqlengths(SNP_ranges_inbound)<-NA
GenomeInfoDb::seqlengths(top_gene_ranges)<-NA
top_genes_vcf<-IB[SNP_ranges_inbound %within% top_gene_ranges]
top_genes_vcf<-IB[SNP_ranges_inbound %within% top_gene_ranges]
my_vcf<-vcf
library(devtools)
load_all
load_all()
sce<-sce
my_vcf<-vcf
top_genes<-common_genes(sce)
getwd()
subset_vcf(my_vcf,sce,top_genes)
library(VariantAnnotation)
load_all()
subset_vcf(my_vcf,sce,top_genes)
knitr::opts_chunk$set(echo = TRUE, engine.path="C:/Windows/System32/bash.exe")
RR<-rowRanges(my_vcf)
#number of inbounds and out of bounds SNPs
sum(end(RR)<seqlengths(RR)[as.character(seqnames(RR))])
sum(end(RR)>seqlengths(RR)[as.character(seqnames(RR))])
# Out of bounds indices
OOB<-myvcf[end(RR)>seqlengths(RR)[as.character(seqnames(RR))]]
myvcf<-my_vcf
RR<-rowRanges(myvcf)
#number of inbounds and out of bounds SNPs
sum(end(RR)<seqlengths(RR)[as.character(seqnames(RR))])
sum(end(RR)>seqlengths(RR)[as.character(seqnames(RR))])
# Out of bounds indices
OOB<-myvcf[end(RR)>seqlengths(RR)[as.character(seqnames(RR))]]
# in bounds subsetting
IB<-myvcf[end(RR)<=seqlengths(RR)[as.character(seqnames(RR))]]
# row ranges of in bounds snps
RR_IB<-rowRanges(IB)
# gene locations from ensdb grch38 version
gns <- genes(EnsDb.Hsapiens.v86)
?genes
library(Seurat)
library(VariantAnnotation)
library(EnsDb.Hsapiens.v86)
library(Matrix)
# row ranges of in bounds snps
RR_IB<-rowRanges(IB)
# gene locations from ensdb grch38 version
gns <- genes(EnsDb.Hsapiens.v86)
# gene locations subsetted by top genes
top_gene_ranges<-gns[mcols(gns)$gene_name %in% top_genes]
# set seqlength for both to NA to as they differ
seqlengths(RR_IB)<-NA
seqlengths(top_gene_ranges)<-NA
# subset snps file to those within ranges of top genes
SNPs_from_top_genes<-IB[RR_IB %within% top_gene_ranges]
SNPs_from_top_genes
# write to vcf file
writeVcf(SNPs_from_top_genes,'./Data/common_variants/SNPs_from_common_genes.vcf')
myvcf<-readVcf("./Data/common_variants/genome1K.phase3.SNP_AF5e2.chr1toX.hg38.vcf","GRCh38")
my_vcf
myvcf
my_vcf[1:5]
head(rowRanges(myvcf))
top_gene_ranges
myvcf<-readVcf("./Data/common_variants/genome1K.phase3.SNP_AF5e2.chr1toX.hg38.vcf","GRCh38")
a<-1:10
a
b<-1:4
a %in% b | a[1:4]
a %in% b | c(1,2)
rowRanges(my_vcf)
my_vcf<-myvcf
rowRanges(my_vcf)
SNP_ranges<-SummarizedExperiment::rowRanges(my_vcf)
my_vcf_inbound<-my_vcf[BiocGenerics::end(SNP_ranges)<=GenomeInfoDb::seqlengths(SNP_ranges)[as.character(GenomeInfoDb::seqnames(SNP_ranges))]]
SNP_ranges_inbound<-SummarizedExperiment::rowRanges(my_vcf_inbound)
gns <- ensembldb::genes(EnsDb.Hsapiens.v86::EnsDb.Hsapiens.v86)
top_gene_ranges<-gns[mcols(gns)$gene_name %in% top_genes]
GenomeInfoDb::seqlengths(SNP_ranges_inbound)<-NA
GenomeInfoDb::seqlengths(top_gene_ranges)<-NA
logi<-SNP_ranges_inbound %within% top_gene_ranges
?sample
sample(1:7000000,100)
sample(1:7000000,10000)
logi2<-logi[sample(1:7000000,10000)]<-TRUE
sum(logi2)
logi[sample(1:7000000,10000)]<-TRUE
sum(logi)
logi<-SNP_ranges_inbound %within% top_gene_ranges
sum(logi)
logi[sample(1:7000000,10000)]<-TRUE
sum(logi)
vcf_sub<-my_vcf_inbound[logi]
vcf_sub
writeVcf(vcf_sub,"vcf_sub.vcf")
load_all()
top_genes<-common_genes(sce)
subset_vcf(vcf_sub,sce,top_genes)
vcf<-vcf_sub
use_data(vcf)
check()
use_gpl3_license()
check()
check()
BiocCheck::BiocCheck()
BiocCheck::BiocCheck()
BiocCheck::BiocCheck()
install()
vignette(SNPcheck)
?vignette
vignette("SNPcheck")
vignette(package="SNPcheck")
library(SNPcheck)
vignette(package="SNPcheck")
?build
build()
load_all()
library(SNPcheck)
library(ComplexHeatmap)
library(viridisLite)
library(SingleCellExperiment)
sce<-sce
vcf<-vcf
snps<-cells_by_snps
getwd()
build()
build()
build()
build()
build()
sce<-add_snps(sce,snps)
load("../Data/sce.rda")
load("../Data/cells_x_snps.rda")
load("../Data/vcf.rda")
snps<-cells_x_snps
top_genes<-common_genes(sce = sce)
subset_vcf(vcf,sce,top_genes = top_genes)
sce<-consensus_calls(sce)
sce<-add_snps(sce,snps)
sce
sce<-add_snps(sce,cells_x_snps)
mat<-cells_x_snps
mat_obs<-mat[(rowSums(mat>0)/dim(mat)[2]) > thresh,]
thresh=0.8
mat_obs<-mat[(rowSums(mat>0)/dim(mat)[2]) > thresh,]
mat_obs[mat_obs==0]<-c(0)
mat_obs[mat_obs==1]<-c(-1)
mat_obs[mat_obs==2]<-1
mat_obs[mat_obs==3]<-1
se<-SingleCellExperiment::SingleCellExperiment(list(counts=mat_obs))
colnames(se)<-colnames(sce)
colnames(sce)
dim(cells_x_snps)
library(devtools)
load_all()
snps<-cels_x_snps
snps<-cells_x_snps
library(SNPcheck)
sce
getwd()
load_all()
sce
library(devtools)
load_all()
sce
sce<-sce
vcf
load("cells_x_snps.rda")
load("C:/Users/michael.lynch/Culhane_Lab Dropbox/Shared_Lab_Folder/SNPs/github/SNPcheck/data/cells_x_snps.rda")
snps<-cells_x_snps[1:10000,]
dim(cells_x_snps)
snps<-cells_x_snps[,1:10000]
use_data(snps)
build()
build()
build()
load("C:/Users/michael.lynch/Culhane_Lab Dropbox/Shared_Lab_Folder/SNPs/github/SNPcheck/data/sce.rda")
add_snps(sce,snps)
sce
snps<-snps[,1:2000]
add_snps(sce,snps)
use_data(snps)
build()
library(devtools)
load_all()
sce
library(SNPcheck)
?set.seed
?knn
source("C:/Users/michael.lynch/Culhane_Lab Dropbox/Shared_Lab_Folder/SNPs/doublets_simulator.R")
train<-counts(altExp(sce,"SNP"))[,sce$intersect==TRUE & sce$citefuse_class=="Singlet" & sce$seurat_class=="Singlet"]
train<-train[,colSums(train!=0)>50]
labels<-sce$citefuse[colnames(sce) %in% colnames(train)]
colnames(train)<-labels
dim(train)
library(ComplexHeatmap)
Heatmap(train,cluster_rows = FALSE,cluster_columns = TRUE,show_row_names = FALSE,show_column_names = FALSE,column_split = labels,cluster_column_slices = FALSE)
Heatmap(train[,labels=="Hashtag4"],cluster_columns = TRUE,cluster_rows = FALSE,show_column_names = FALSE)
labels<-droplevels(labels)
combs<-expand.grid(levels(labels),levels(labels))
combs
length(combs)
dim(combs)[1]
combs<-combs[combs$Var1!=combs$Var2,]
combs
combs2<-paste0(combs$Var1,combs$Var2)
Hashtag1<-train[,labels=="Hashtag1"]
Hashtag2<-train[,labels=="Hashtag2"]
Hashtag3<-train[,labels=="Hashtag3"]
Hashtag4<-train[,labels=="Hashtag4"]
Hashtag5<-train[,labels=="Hashtag5"]
#########
all<-c()
for (i in 1:length(combs2)) {
l1<-as.character(combs$Var1[i])
l2<-as.character(combs$Var2[i])
d1<-train[,labels==l1]
d2<-train[,labels==l2]
s1<-sample(1:dim(d1)[2],100)
s2<-sample(1:dim(d2)[2],100)
load("C:/Users/michael.lynch/Documents/snps_files.RData")
sce<-consensus_calls(sce)
sce<-add_snps(sce,cells_x_snps)
sce<-sce[,sce$nFeature_RNA>1000]
sce
train<-counts(altExp(sce,"SNP"))[,sce$intersect==TRUE & sce$citefuse_class=="Singlet" & sce$seurat_class=="Singlet"]
train<-train[,colSums(train!=0)>50]
labels<-sce$citefuse[colnames(sce) %in% colnames(train)]
colnames(train)<-labels
dim(train)
library(ComplexHeatmap)
#Heatmap(train,cluster_rows = FALSE,cluster_columns = TRUE,show_row_names = FALSE,show_column_names = FALSE,column_split = labels,cluster_column_slices = FALSE)
Heatmap(train[,labels=="Hashtag4"],cluster_columns = TRUE,cluster_rows = FALSE,show_column_names = FALSE)
labels<-droplevels(labels)
combs<-expand.grid(levels(labels),levels(labels))
combs
length(combs)
dim(combs)[1]
combs<-combs[combs$Var1!=combs$Var2,]
combs
combs2<-paste0(combs$Var1,combs$Var2)
Hashtag1<-train[,labels=="Hashtag1"]
Hashtag2<-train[,labels=="Hashtag2"]
Hashtag3<-train[,labels=="Hashtag3"]
Hashtag4<-train[,labels=="Hashtag4"]
Hashtag5<-train[,labels=="Hashtag5"]
#########
all<-c()
for (i in 1:length(combs2)) {
l1<-as.character(combs$Var1[i])
l2<-as.character(combs$Var2[i])
d1<-train[,labels==l1]
d2<-train[,labels==l2]
s1<-sample(1:dim(d1)[2],100)
s2<-sample(1:dim(d2)[2],100)
doubs<-d1[,s1]==1 | d2[,s2]==1
doubs<-doubs*1
doubs[doubs==0]<-c(-1)
colnames(doubs)<-rep("Doublet",length(colnames(doubs)))#rep(paste0(l1,l2),length(colnames(doubs)))
all<-cbind(all,doubs)
}
source("C:/Users/michael.lynch/Culhane_Lab Dropbox/Shared_Lab_Folder/SNPs/doublets_simulator.R")
sce$knn_doub
table(sce$knn_doub)
Heatmap(test[,],show_column_names = FALSE,cluster_rows = FALSE,column_split = sce$knn_doub)
Heatmap(test[,sce$knn_doub=="Doublet"],show_column_names = FALSE,cluster_rows = FALSE,column_split = sce$seurat[sce$knn_doub=="Doublet"])
Heatmap(test[,sce$knn_doub=="Hashtag1"],show_column_names = FALSE,cluster_rows = FALSE,column_split = sce$seurat[sce$knn_doub=="Hashtag1"])
Heatmap(test[,sce$knn_doub=="Hashtag2"],show_column_names = FALSE,cluster_rows = FALSE,column_split = sce$seurat[sce$knn_doub=="Hashtag2"])
Heatmap(test[,sce$knn_doub=="Hashtag3"],show_column_names = FALSE,cluster_rows = FALSE,column_split = sce$seurat[sce$knn_doub=="Hashtag3"])
Heatmap(test[,sce$knn_doub=="Hashtag4"],show_column_names = FALSE,cluster_rows = FALSE,column_split = sce$seurat[sce$knn_doub=="Hashtag4"])
Heatmap(test[,sce$knn_doub=="Hashtag5"],show_column_names = FALSE,cluster_rows = FALSE,column_split = sce$seurat[sce$knn_doub=="Hashtag5"])
Heatmap(test[,sce$knn_doub=="Doublet"],show_column_names = FALSE,cluster_rows = FALSE,column_split = sce$seurat[sce$knn_doub=="Doublet"])
install()
install()
htos<-as.data.frame(t(logcounts(altExp(sce,"HTO"))))
x1<-gghistogram(htos,x="Hashtag1",fill =dittoColors(1)[1],palette = "lancet",xlim=c(0,7),ylim=c(0,8000),alpha=1)
library(ggplot2)
htos<-as.data.frame(t(logcounts(altExp(sce,"HTO"))))
x1<-gghistogram(htos,x="Hashtag1",fill =dittoColors(1)[1],palette = "lancet",xlim=c(0,7),ylim=c(0,8000),alpha=1)
library(ggpubr)
install.packages("tidyr")
install.packages("tidyr")
library(tidyr)
detach("package:tidyr", unload = TRUE)
install.packages("tidyr")
detach("tidyr")
install.packages("ggpubr")
library(ggpubr)
remove.packages("tidyr")
install.packages("tidyr")
library(ggpubr)
